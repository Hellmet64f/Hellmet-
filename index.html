<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Simulador de Biodegradação com Ideonella sakaiensis</title>
    
    <!-- CSS embutido no HTML -->
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;700&display=swap');

        body {
            font-family: 'Roboto', sans-serif;
            background-color: #f0f2f5;
            color: #333;
            line-height: 1.6;
            margin: 0;
            padding: 20px;
        }

        .container {
            max-width: 800px;
            margin: auto;
            background: #fff;
            padding: 25px 40px;
            border-radius: 10px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
        }

        header {
            text-align: center;
            border-bottom: 2px solid #e0e0e0;
            padding-bottom: 20px;
            margin-bottom: 20px;
        }

        h1 {
            color: #0b5f2c;
            font-weight: 700;
        }

        h2 {
            color: #1e8449;
            border-bottom: 1px solid #ddd;
            padding-bottom: 5px;
            margin-top: 30px;
        }
        
        .slide {
            margin-bottom: 25px;
            padding: 15px;
            background-color: #f9f9f9;
            border-left: 5px solid #1abc9c;
            border-radius: 5px;
        }

        .slide img {
            max-width: 100%;
            height: auto;
            display: block;
            margin: 15px auto;
            border-radius: 8px;
        }
        
        ul, ol {
            padding-left: 20px;
        }
        
        li {
            margin-bottom: 10px;
        }
        
        /* Estilos do Simulador */
        #canvas-container {
            width: 100%;
            height: 450px;
            background: #eafaf1;
            border-radius: 8px;
            margin-top: 20px;
            cursor: grab;
        }

        .controls {
            text-align: center;
            padding: 20px;
            background-color: #f4f4f4;
            border-radius: 8px;
            margin-top: 20px;
        }

        .controls label {
            font-weight: bold;
            margin-right: 15px;
        }
        
        #degradation-slider {
            width: 60%;
            vertical-align: middle;
        }

        #slider-value {
            font-weight: bold;
            color: #0b5f2c;
            min-width: 50px;
            display: inline-block;
        }

        .info-text {
            text-align: center;
            font-style: italic;
            color: #666;
            margin-top: 15px;
        }
    </style>
</head>
<body>

    <div class="container">
        <!-- SEÇÃO INFORMATIVA (SLIDES) -->
        <header>
            <h1>Ideonella sakaiensis: A Bactéria que come Plástico</h1>
            <p>Uma solução biológica para o problema do plástico PET.</p>
        </header>

        <section class="slide">
            <h2>O que é a Ideonella sakaiensis?</h2>
            <p>
                É uma bactéria descoberta em 2016 no Japão, encontrada em uma usina de reciclagem de garrafas PET. Sua característica mais notável é a capacidade de usar o plástico PET (Tereftalato de polietileno) como sua principal fonte de alimento e energia, algo inédito na natureza.
            </p>
            <img src="https://i.imgur.com/gSjAmgC.jpeg" alt="Ilustração da bactéria Ideonella sakaiensis">
        </section>

        <section class="slide">
            <h2>Como ela "come" o plástico?</h2>
            <p>A bactéria produz duas enzimas especiais para quebrar o plástico:</p>
            <ol>
                <li><strong>PETase:</strong> Age na superfície do plástico, quebrando suas longas e resistentes cadeias de polímero em moléculas menores, chamadas MHET.</li>
                <li><strong>MHETase:</strong> A bactéria absorve o MHET e usa esta segunda enzima para quebrá-lo em seus componentes básicos e inofensivos: ácido tereftálico e etilenoglicol.</li>
            </ol>
            <p>Esses componentes são então usados pela bactéria como alimento, fechando o ciclo de reciclagem de forma limpa e biológica.</p>
        </section>

        <!-- SEÇÃO DO SIMULADOR 3D -->
        <section id="simulador">
            <h2>Simulador 3D de Biodegradação</h2>
            <p class="info-text">Interaja com a garrafa: clique e arraste para girar, use a roda do mouse para dar zoom. Use o controle deslizante para simular a ação das enzimas.</p>
            
            <div id="canvas-container">
                <!-- O 3D será renderizado aqui -->
            </div>
    
            <div class="controls">
                <label for="degradation-slider">Nível de Degradação</label>
                <input type="range" id="degradation-slider" min="0" max="100" value="0">
                <span id="slider-value">0%</span>
            </div>
        </section>
    </div>

    <!-- SCRIPT DO SIMULADOR (THREE.JS) -->
    
    <!-- 1. Import Map: Diz ao navegador onde encontrar o Three.js e seus complementos -->
    <script type="importmap">
        {
            "imports": {
                "three": "https://unpkg.com/three@0.160.0/build/three.module.js",
                "three/addons/": "https://unpkg.com/three@0.160.0/examples/jsm/"
            }
        }
    </script>

    <!-- 2. Módulo Principal: Onde a mágica acontece -->
    <script type="module">
        import * as THREE from 'three';
        import { OrbitControls } from 'three/addons/controls/OrbitControls.js';
        import { GLTFLoader } from 'three/addons/loaders/GLTFLoader.js';

        // --- SHADERS: A "RECEITA" PARA O EFEITO DE DISSOLVER ---
        const vertexShader = `
            varying vec3 vPosition;
            void main() {
                vPosition = position;
                gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);
            }
        `;

        const fragmentShader = `
            uniform float u_progress;
            uniform vec3 u_color;
            varying vec3 vPosition;

            // Função de ruído para criar um padrão de dissolução orgânico
            float random(vec3 st) {
                return fract(sin(dot(st.xyz, vec3(12.9898, 78.233, 151.7182))) * 43758.5453123);
            }

            void main() {
                // Se o ruído em uma posição for maior que o progresso, o pixel é visível
                // Aumentamos a escala da posição para criar um ruído mais "granulado"
                if (random(vPosition * 8.0) > u_progress) {
                    gl_FragColor = vec4(u_color, 0.9); // Cor e transparência da garrafa
                } else {
                    discard; // Descarta o pixel, criando o "buraco"
                }
            }
        `;

        // --- CONFIGURAÇÃO DA CENA 3D ---
        const container = document.getElementById('canvas-container');
        const scene = new THREE.Scene();
        const camera = new THREE.PerspectiveCamera(75, container.clientWidth / container.clientHeight, 0.1, 1000);
        camera.position.set(0, 1.5, 4);

        const renderer = new THREE.WebGLRenderer({ antialias: true, alpha: true });
        renderer.setSize(container.clientWidth, container.clientHeight);
        renderer.setPixelRatio(window.devicePixelRatio);
        container.appendChild(renderer.domElement);

        // --- ILUMINAÇÃO ---
        const ambientLight = new THREE.AmbientLight(0xffffff, 0.8);
        scene.add(ambientLight);
        const directionalLight = new THREE.DirectionalLight(0xffffff, 1);
        directionalLight.position.set(5, 10, 7.5);
        scene.add(directionalLight);

        // --- CONTROLES DA CÂMERA ---
        const controls = new OrbitControls(camera, renderer.domElement);
        controls.enableDamping = true;
        controls.dampingFactor = 0.05;
        controls.minDistance = 2;
        controls.maxDistance = 10;
        controls.target.set(0, 1, 0);

        // --- MATERIAL CUSTOMIZADO COM O SHADER ---
        const shaderMaterial = new THREE.ShaderMaterial({
            uniforms: {
                u_progress: { value: 0.0 },
                u_color: { value: new THREE.Color(0x28a745) } // Verde garrafa
            },
            vertexShader: vertexShader,
            fragmentShader: fragmentShader,
            transparent: true,
            side: THREE.DoubleSide
        });

        // --- CARREGADOR DO MODELO 3D ---
        const loader = new GLTFLoader();
        // URL de um modelo 3D de garrafa PET gratuito e disponível publicamente
        const modelURL = 'https://cdn.jsdelivr.net/gh/mrdoob/three.js@master/examples/models/gltf/Bottle.glb';
        
        loader.load(modelURL, (gltf) => {
            const model = gltf.scene;
            
            // Centraliza e ajusta a escala do modelo
            model.scale.set(10, 10, 10);
            model.position.y = 0;

            // Aplica nosso material customizado a todas as partes do modelo
            model.traverse((child) => {
                if (child.isMesh) {
                    child.material = shaderMaterial;
                }
            });

            scene.add(model);
        }, undefined, (error) => {
            console.error('Ocorreu um erro ao carregar o modelo 3D:', error);
            container.innerHTML = '<p style="text-align:center; padding-top: 50px;">Falha ao carregar o modelo 3D. Verifique sua conexão.</p>';
        });

        // --- INTERATIVIDADE DO SLIDER ---
        const slider = document.getElementById('degradation-slider');
        const sliderValueDisplay = document.getElementById('slider-value');

        slider.addEventListener('input', (event) => {
            const progress = parseFloat(event.target.value) / 100.0;
            // Atualiza o valor 'uniform' no shader
            shaderMaterial.uniforms.u_progress.value = progress;
            sliderValueDisplay.textContent = `${event.target.value}%`;
        });

        // --- RESPONSIVIDADE DA JANELA ---
        window.addEventListener('resize', () => {
            camera.aspect = container.clientWidth / container.clientHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(container.clientWidth, container.clientHeight);
        });

        // --- LOOP DE ANIMAÇÃO ---
        function animate() {
            requestAnimationFrame(animate);
            controls.update(); // Necessário para o 'enableDamping'
            renderer.render(scene, camera);
        }

        animate();
    </script>
</body>
  </html>
